<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="adminMapper">

	<!-- 배너 이미지 존재 여부 확인 -->
	<select id="checkBanner" resultType='Image'>
		select *
			from image
			where img_ref_type = 'BANNER' and img_ref_num = #{i}
	</select>
	
	<!-- 한눈에 보기 이미지 존재 여부 확인 -->
	<select id="checkOneeye" resultType='Image'>
		select *
			from image
			where img_ref_type = 'ONEEYE' and img_ref_num = #{i}
	</select>
	
	<!-- 동물 -->
	<select id="getAnimalCount" resultType="int">
        select count(*)
        from ANIMAL
    </select>
	
 	<select id="selectFamilyList" resultMap="AnimalList">
    SELECT *
    FROM animal
    ORDER BY ANI_NO ASC
	</select>
	
	<resultMap type="Animal" id="AnimalList">
        <id column="ANI_NO" property="aniNO"/>
        <result column="ANMAL_CLASS" property="animalClass"/>
        <result column="ANIMAL_FAMILY" property="animalFamily"/>
        <result column="ANIMAL_NAME" property="animalName"/>
        <result column="ENTER_DATE" property="enterDate"/>
        <result column="EXTINCT_GRADE" property="extinctGrade"/>
        <result column="UPLOAD_DATE" property="uploadDate"/>
	</resultMap>
	
	<!-- 동물 정보 조회 -->
    <select id="selectAnimal" resultMap="AnimalList" parameterType="int">
	    SELECT *
	    FROM ANIMAL
	    WHERE ANI_NO = #{aniNO}
	</select>
    
	<!--  동물 추가 -->
	<insert id="insertAnimal"> 
		INSERT INTO ANIMAL VALUES (seq_animal.nextval, #{animalClass}, #{animalFamily}, #{animalName}, sysdate, #{extinctGrade}, sysdate)
	</insert>
	
    <!-- 동물 정보 수정 -->
    <update id="updateAnimal" parameterType="Animal">
        UPDATE ANIMAL
        SET 
            ANMAL_CLASS = #{animalClass},
            ANIMAL_FAMILY = #{animalFamily},
            ANIMAL_NAME = #{animalName},
            EXTINCT_GRADE = #{extinctGrade}
        WHERE ANI_NO = #{aniNO}
    </update>
    
	<!--  동물 삭제 +수정+ ( ) 는 체크박스를 여러개 체크시 함께 삭제를 위한 코드입니다.-->
	<delete id="deleteAnimal" parameterType="list">
    DELETE FROM ANIMAL
    WHERE ANI_NO IN
    <foreach collection="list" item="aniNO" open="(" separator="," close=")">
        #{aniNO}
    </foreach>
	</delete>
	
	<!-- family에 동물보이기
	<select id="getAllAnimal">
		SELECT *
		FROM ANIMAL
		ORDER BY ANIMAL_CLASS, ANIMAL_NO
	</select> -->
	
	<!-- 마스코트 부분 -->
	
	<!-- 마스코트 목록 조회 -->
	<select id="selectMascotList" resultMap="goodsResultMap">
    SELECT * FROM GOODS ORDER BY GOODS_NO
	</select>
	
    <!-- 특정 상품 정보 가져오기 -->
    <select id="selectGoods" parameterType="int" resultMap="goodsResultMap">
        SELECT * FROM GOODS WHERE GOODS_NO = #{goodsNo}
    </select>

    <!-- 상품 정보 업데이트 -->
    <update id="updateGoods" parameterType="Goods">
        UPDATE GOODS
        SET GOODS_NAME = #{goodsName},
            GOODS_PRICE = #{goodsPrice},
            GOODS_INFO = #{goodsInfo}
        WHERE GOODS_NO = #{goodsNo}
    </update>

    <!-- 상품 삭제 -->
    <delete id="deleteGoods" parameterType="int">
        DELETE FROM GOODS WHERE GOODS_NO = #{goodsNo}
    </delete>

    <!-- 새 상품 추가 -->
    <insert id="insertGoods" parameterType="Goods">
        INSERT INTO GOODS (GOODS_NO, GOODS_NAME, GOODS_PRICE, GOODS_INFO)
        VALUES (SEQ_GOODS.NEXTVAL, #{goodsName}, #{goodsPrice}, #{goodsInfo})
    </insert>

    <!-- Goods 결과 매핑 -->
    <resultMap id="goodsResultMap" type="Goods">
        <id property="goodsNo" column="GOODS_NO"/>
        <result property="goodsName" column="GOODS_NAME"/>
        <result property="goodsPrice" column="GOODS_PRICE"/>
        <result property="goodsInfo" column="GOODS_INFO"/>
    </resultMap>
    
    <!-- 배너/한눈에보기 이미지 업데이트 -->
    <update id="updateMainImg">
    	update image
    		set img_path = #{imgPath}, img_name = #{imgName}, img_Rename = #{imgRename}
    		where img_ref_num = #{imgRefNum} and img_ref_type = #{imgRefType}
    </update>
    <!-- 배너/한눈에보기 이미지 업데이트 -->
    
    <!-- 배너/한눈에보기 이미지 저장 -->
    <insert id="insertMainImg">
    	insert into image
    		values(seq_img.nextval, #{imgPath}, #{imgName}, #{imgRename}, #{imgRefNum}, #{imgRefType}, default, #{imgRefHover})
    </insert>
    <!-- 배너/한눈에보기 이미지 저장 -->
    
    <!-- 메인 화면 : 배너 이미지 -->
    <select id="getBannerImg" resultType='image'>
    	select *
    	from image
    	where img_ref_type = 'BANNER'
    </select>
    <!-- 메인 화면 : 배너 이미지 -->
    
    <!-- 메인 화면 : 한눈에보기 이미지 -->
    <select id="getOneeyeImg"  resultType='image'>
    	select *
    	from image
    	where img_ref_type = 'ONEEYE'
    </select>
    <!-- 메인 화면 : 한눈에보기 이미지 -->
    
    <!-- 메인 화면 : 배너 링크 -->
    <select id="getBannerLink" resultType='Link'>
    	select *
    	from link
    	where link_ref_type = 'BANNER'
    </select>
    <!-- 메인 화면 : 배너 링크 -->
    
    <!-- 메인 화면 : 한눈에보기 링크 -->
    <select id="getOneeyeLink" resultType='Link'>
    	select *
    	from link
    	where link_ref_type = 'ONEEYE'
    </select>
    <!-- 메인 화면 : 배한눈에보기너 링크 -->
    
    <!-- 배너/한눈에보기 링크 수정 -->
    <update id="updateMainLink">
    	update Link
    	set link_url = #{linkUrl}
    	where link_ref_num = #{linkRefNum} and link_ref_type = #{linkRefType}
    </update>
    <!-- 배너/한눈에보기 링크 수정 -->
    
    <!-- 배너/한눈에보기 링크 추가 -->
    <insert id="insertMainLink">
    	insert into link
    		values(seq_link.nextval, #{linkUrl}, null, #{linkRefType}, #{linkRefNum})
    </insert>
    <!-- 배너/한눈에보기 링크 추가 -->
    
    <!-- 프로그램 글 목록 수 조회 -->
    <select id="getShowListCount" resultType='_int'>
    	select count(*)
    		from show
    </select>
    <!-- 프로그램 글 목록 수 조회 -->
    
    <!-- 프로그램 글 목록 조회 -->
    <select id="getShowList" resultType='Show'>
    	select *
    		from show
    		order by show_no desc
    </select>
    <!-- 프로그램 글 목록 수 조회 -->
    
    <!-- 프로그램 추가 -->
	<insert id="insertShow">
		<selectKey order="BEFORE" keyProperty="showNo" resultType="_int">
			select seq_show.nextval from dual
		</selectKey>
		insert into show
			values(#{showNo}, #{showName}, #{showContent}, sysdate)
	</insert>
    <!-- 프로그램 추가 -->
    
    <!-- 프로그램 상세 보기 -->
    <select id="getShow" resultType='Show'>
    	select *
    		from show
    		where show_no = #{showNo}
    </select>
    <!-- 프로그램 상세 보기 -->
    
    <!-- 프로그램 상세 이미지 보기 -->
    <select id="getImg" resultType="Image">
    	select *
    		from image
    		where img_ref_num = #{imgRefNum} and img_ref_type = #{imgRefType} and img_ref_hover = #{imgRefHover}
    </select>
    <!-- 프로그램 상세 이미지 보기 -->
    
    <!-- 프로그램 삭제 -->
    <delete id="deleteShow">
    	delete from show
    	where show_no = #{showNo}
    </delete>
    <!-- 프로그램 삭제 -->
    
    <!-- 프로그램 이미지 삭제 -->
    <delete id="deleteImg">
    	delete from image
    	where img_ref_num = #{showNo} and img_ref_type = #{imgRefType} and img_ref_hover = #{imgRefHover}
    </delete>
    <!-- 프로그램 이미지 삭제 -->
    
    <!-- 이미지 리스트 가져오기 -->
    <select id="getImgList" resultType='Image'>
    	select *
    	from image
    		where img_ref_num = #{showNo} and img_ref_type = 'SHOW'
    </select>
	<!-- 이미지 리스트 가져오기 --> 
	
	<!-- 프로그램 수정 -->
	<update id="updateShow">
		update show
			set show_name = #{showName}, show_content = #{showContent}
			where show_no = #{showNo}
	</update>
	<!-- 프로그램 수정 -->
    
    <!-- 프로그램 이미지 수정 -->
    <update id="updateShowImg">
    	update image
    		set img_name = #{image.imgName}, img_path = #{image.imgPath}, img_rename = #{image.imgRename}
    		where img_rename = #{deleteImg}
    </update>
    <!-- 프로그램 이미지 수정 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
</mapper>
